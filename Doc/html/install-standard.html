<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>2.2. Instalacja standardowa</title><link rel="stylesheet" type="text/css" href="static/aquapi.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Komputer akwariowy AquaPi" /><link rel="up" href="install.html" title="Rozdział 2. Instalacja AquaPi" /><link rel="prev" href="install.html" title="Rozdział 2. Instalacja AquaPi" /><link rel="next" href="configure.html" title="Rozdział 3. Konfiguracja AquaPi" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">2.2. Instalacja standardowa</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="install.html">Poprzedni</a> </td><th width="60%" align="center">Rozdział 2. Instalacja AquaPi</th><td width="20%" align="right"> <a accesskey="n" href="configure.html">Następny</a></td></tr></table><hr /></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="install-standard"></a>2.2. Instalacja standardowa</h2></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-1"></a>2.2.1. Ściągnij i zainstaluj najnowszą wersję rapsbiana.</h3></div></div></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip: Podpowiedź"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Podpowiedź]" src="static/tip.png" /></td><th align="left">Podpowiedź</th></tr><tr><td align="left" valign="top"><p>Instrukcję instalacji Raspbiana znajdziesz na stronie poświęconej Raspbery Pi.</p></td></tr></table></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning: Uwaga"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Ostrzeżenie]" src="static/warning.png" /></td><th align="left">Uwaga</th></tr><tr><td align="left" valign="top"><p>Na karcie 2GB raczej się nie zmieścisz. Powinieneś mieć min 4GB kartę i powinieneś wykonać extend filesystem.</p></td></tr></table></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-2"></a>2.2.2. Zaktualizuj system, i zainstaluj potrzebne pakiety.</h3></div></div></div><pre class="screen">
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>apt-get update</code></strong> 
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>apt-get upgrade</code></strong> 
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>apt-get install mysql-server mysql-client libmysqlclient-dev lighttpd php5-cgi php5-mysql git libxml2-dev</code></strong> 
</pre><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning: Uwaga"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Ostrzeżenie]" src="static/warning.png" /></td><th align="left">Uwaga</th></tr><tr><td align="left" valign="top"><p>Przy instalacji mysql-server system poprosi o nadanie hasła dla administratora mysql. To hasło przyda się później, więc zapamiętaj jakie to hasło.</p></td></tr></table></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-3"></a>2.2.3. Włącz obsługę 1-wire i i2c (obsługa sensorów temperatury oraz urządzeń i2c).</h3></div></div></div><p>Włączenie obsługi 1-wire polega na dodaniu do /etc/modules wpisów w1-gpio i w1-therm</p><p>Włączenie obsługi i2c polega na dodaniu do /etc/modules wpisów i2c-bcm2708 i i2c-dev</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip: Podpowiedź"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Podpowiedź]" src="static/tip.png" /></td><th align="left">Podpowiedź</th></tr><tr><td align="left" valign="top"><p>Obsługa i2c jest wymagana jeśli chcesz korzystać z ekspanderów I2C takich jak PCF8574 bądź Sparky's Widgets MinipH</p></td></tr></table></div><pre class="screen"><code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>nano /etc/modules</code></strong></pre><pre class="programlisting"># /etc/modules: kernel modules to load at boot time.
#
# This file contains the names of kernel modules that should be loaded
# at boot time, one per line. Lines beginning with "#" are ignored.
# Parameters can be specified after the module name.

snd-bcm2835
#obsługa 1-wire
w1-gpio
w1-therm
#obsługa i2c
i2c-bcm2708
i2c-dev</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-4"></a>2.2.4. Skonfiguruj serwer www i php</h3></div></div></div><p>Aby włączyć obsługę php5 w lighttpd musisz zmodyfikować dwa pliki, /etc/php5/cgi/php.ini i /etc/lighttpd/lighttpd.conf. 
			Najpierw otwórz /etc/php5/cgi/php.ini i dodaj linię cgi.fix_pathinfo = 1 na samym końcu pliku:</p><pre class="screen"><code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>nano /etc/php5/cgi/php.ini</code></strong></pre><pre class="programlisting">cgi.fix_pathinfo = 1</pre><p>Teraz otwórz /etc/lighttpd/lighttpd.conf i dodaj "mod_fastcgi", do sekcji server.modules : </p><pre class="screen"><code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>nano /etc/lighttpd/lighttpd.conf</code></strong></pre><pre class="programlisting">server.modules = (
	"mod_access",
	"mod_alias",
	"mod_compress",
	"mod_redirect",
	"mod_fastcgi",
#       "mod_rewrite",
)</pre><p>A następnie na końcu pliku dodaj następującą sekcję:</p><pre class="programlisting">fastcgi.server = ( ".php" =&gt; ((
                     "bin-path" =&gt; "/usr/bin/php5-cgi",
                     "socket" =&gt; "/tmp/php.socket"
                 )))</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-5"></a>2.2.5. Zresetuj Pi.</h3></div></div></div><pre class="screen"><code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>shutdown -r now</code></strong></pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-6"></a>2.2.6. Ściągnij pliki AquaPi.</h3></div></div></div><p>Pliki AquaPi można znaleźć na oficjalnej stronie projektu, czyli na <a class="ulink" href="http://aquapi.polarnet.pl/" target="_top">http://aquapi.polarnet.pl/</a> Na tej
			stronie znajdziesz wydania stabilne, jak i gotowe obrazy do nagrania na kartę.</p><p>Możesz również ściągnąć pliki bezpośrednio z repozytorium GitHub:</p><pre class="screen"><code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>cd /usr/local/src</code></strong>
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>git clone https://github.com/lexx-polarnet-pl/AquaPi.git</code></strong>
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>cd AquaPi</code></strong>
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>git checkout 1.0</code></strong></pre><p>Teraz pobrałeś wszystkie pliki projektu. </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning: Uwaga"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Ostrzeżenie]" src="static/warning.png" /></td><th align="left">Uwaga</th></tr><tr><td align="left" valign="top"><p>Wersja, którą pobrałeś z GitHub może nie działać stabilnie, lub nawet wcale.</p></td></tr></table></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-7"></a>2.2.7. Skonfiguruj bazę danych</h3></div></div></div><p>Wejdź w mysql monitor:
</p><pre class="screen"><code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>mysql -u root -p</code></strong> 
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.</pre><p>		  
		  </p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip: Podpowiedź"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Podpowiedź]" src="static/tip.png" /></td><th align="left">Podpowiedź</th></tr><tr><td align="left" valign="top"><p>mysql zapyta o hasło roota. To hasło podawałeś w trakcie instalacji</p></td></tr></table></div><p>
			Utwórz użytkownika, bazę i tabele:
</p><pre class="screen"><code class="prompt">mysql&gt; </code><strong class="userinput"><code>CREATE DATABASE IF NOT EXISTS `aquapi`;</code></strong> 
<code class="prompt">mysql&gt; </code><strong class="userinput"><code>ALTER DATABASE `aquapi` DEFAULT CHARACTER SET utf8 COLLATE utf8_polish_ci;</code></strong> 
<code class="prompt">mysql&gt; </code><strong class="userinput"><code>CREATE USER 'aquapi'@'localhost' IDENTIFIED BY 'aquapi';</code></strong> 
<code class="prompt">mysql&gt; </code><strong class="userinput"><code>GRANT ALL PRIVILEGES ON `aquapi`.* TO 'aquapi';</code></strong> 
<code class="prompt">mysql&gt; </code><strong class="userinput"><code>USE aquapi;</code></strong></pre><p>
			a potem utwórz tabele najlepiej posiłkując się plikiem Software/aquapi.sql
</p><pre class="screen"><code class="prompt">mysql&gt; </code><strong class="userinput"><code>SOURCE /usr/local/src/AquaPi/Software/aquapi.sql</code></strong>
<code class="prompt">mysql&gt; </code><strong class="userinput"><code>QUIT</code></strong></pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-8"></a>2.2.8. Zainstaluj WiringPi</h3></div></div></div><p>Przejdź do katalogu Software/daemon/wiringPi/wiringPi i odpal instalację:</p><pre class="screen"><code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>cd Software/daemon/wiringPi/wiringPi</code></strong> 
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>make all</code></strong> 
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>make install</code></strong></pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-9"></a>2.2.9. Zainstaluj demona</h3></div></div></div><p>Wejdź do katalogu daemon i odpal make. Po kompilacji demona możesz uruchomić przez ./aquapi, jednak lepiej robić to z RC.</p><pre class="screen"><code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>cd ..</code></strong> 
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>make</code></strong> 
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>mkdir /usr/local/aquapi/</code></strong>
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>cp aquapi /usr/local/aquapi/</code></strong></pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-10"></a>2.2.10. Dodaj skrypty do RC</h3></div></div></div><p>Żeby demon skopiować aquapi.rc do /etc/init.d/ a następnie uruchomić update-rc.d aquapi.rc defaults</p><pre class="screen"><code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>cd ..</code></strong> 
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>cp aquapi.rc /etc/init.d/</code></strong> 
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>chmod +x /etc/init.d/aquapi.rc</code></strong>
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>update-rc.d aquapi.rc defaults</code></strong></pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-11"></a>2.2.11. Skopiuj pliki z WebUI</h3></div></div></div><p>Teraz skopiuj pliki zawierające WebUI do katalogu /var/www/</p><pre class="screen"><code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>cp -r WebUI/* /var/www/</code></strong> 
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>chmod 775 -R /var/www/</code></strong> 
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>mkdir /var/www/smarty/templates_c/</code></strong>
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>chmod 777 /var/www/smarty/templates_c/</code></strong></pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-12"></a>2.2.12. Stwórz plik aquapi.ini</h3></div></div></div><p>Najprościej skopiować przykładowy plik zawarty w pakiecie do katalogu /etc i dokonać edycji:
</p><pre class="screen"><code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>cp aquapi.ini /etc/</code></strong> 
<code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>nano /etc/aquapi.ini</code></strong></pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="install-standard-13"></a>2.2.13. Dokonaj końcowej konfiguracji</h3></div></div></div><p>Przeprowadź konfigurację wchodząc przeglądarką na Twoje Pi. Po tym uruchom demona:
</p><pre class="screen"><code class="prompt">root@raspberrypi:~# </code><strong class="userinput"><code>/etc/init.d/aquapi.rc start</code></strong></pre><p>
		  Gratulacje! Twoje AquaPi powinno już działać :)</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="install.html">Poprzedni</a> </td><td width="20%" align="center"><a accesskey="u" href="install.html">Początek rozdziału</a></td><td width="40%" align="right"> <a accesskey="n" href="configure.html">Następny</a></td></tr><tr><td width="40%" align="left" valign="top">Rozdział 2. Instalacja AquaPi </td><td width="20%" align="center"><a accesskey="h" href="index.html">Spis treści</a></td><td width="40%" align="right" valign="top"> Rozdział 3. Konfiguracja AquaPi</td></tr></table></div></body></html>